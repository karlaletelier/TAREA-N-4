(function(app,$,undefined){currencySettings={};function convertCurrency(options){var settings=$.extend({},currencySettings,options);if(!("newCurrency" in settings)){return}var currentRate=settings.currentCurrency===settings.newCurrency?1:settings.rates[settings.currentCurrency],newRate=settings.rates[settings.newCurrency],symbol=settings.newCurrency in settings.symbols?settings.symbols[settings.newCurrency]:settings.newCurrency,$price,money;$(settings.targets).not(".tg_translated").each(function(){$price=$(this);money=Number($price.text().replace(/[^0-9\.\-]+/g,""));if(money!=""){result=Number((money/currentRate*newRate).toFixed(2)).toLocaleString();if(result.indexOf(".")===-1){result+=".00"}else{if(result.indexOf(".")+2===result.length){result+="0"}}$price.html('<span class="symbol">'+symbol+"</span>"+result)}$price.addClass("tg_translated")});currencySettings.currentCurrency=settings.newCurrency;currencySettings.newCurrency=settings.newCurrency;var date=new Date();date.setTime(date.getTime()+31536000000);document.cookie="tgCurrency="+settings.newCurrency+"; expires="+date+"; path=/";setSessionCurrency()}function setSessionCurrency(){var currency=getTGCurrencyCookie();var url=window.location.href;var page=url.substring(url.lastIndexOf("/")+1);var pipeline="Currency-SetSessionCurrency";var Urls=url.replace(page,pipeline);$.ajax({dataType:"json",method:"POST",url:Urls,data:{format:"ajax",currencyMnemonic:currency}}).done(function(response){if(!response.success){throw new Error("Currency Not Set")}})}function getTGCurrencyCookie(){var cookieStart=document.cookie.indexOf("tgCurrency");var cookieCurrency;if(cookieStart!==-1){var cookieEnd=document.cookie.indexOf(";",cookieStart);if(cookieEnd===-1){cookieCurrency=document.cookie.substring(cookieStart+11)}else{cookieCurrency=document.cookie.substring(cookieStart+11,cookieEnd)}}else{cookieCurrency=""}return cookieCurrency}function openWelcomeMat(){var options={width:500,open:function(){$(".intl_popup form").submit(function(e){e.preventDefault();var $form=$(this);var newCurrency=$form.find("select").val();$.ajax({url:$form[0].action,data:$form.serialize(),type:"post"});$(".tg_translated").removeClass("tg_translated");convertCurrency({newCurrency:newCurrency});$("#welMat").dialog("close")})}};$("#welMat").dialog(options)}app.tgcommerce={init:function(){},initAddress:function(){$('select[id$="_country"]',$(".address")).on("change",function(){if(app.tgresources.tgCommerceHidePostalCode!=null){var hidePostCodes=app.tgresources.tgCommerceHidePostalCode.split(",");$(".address").find(".form-row.postal-code,.form-row.postal-code input").addClass("required");if(hidePostCodes.indexOf($(this).val())>-1){$(".address").addClass("hide-postal-code");$(".address").find(".form-row.postal-code,.form-row.postal-code input").removeClass("required").removeClass("error");return}}$(".address").removeClass("hide-postal-code")});$('select[id$="_country"]',$(".address")).trigger("change");$('select[id$="_country"]').each(function(){if(app.tgresources.tgCommerceHidePostalCode!=null){var hidePostCodes=app.tgresources.tgCommerceHidePostalCode.split(",");if(hidePostCodes.indexOf($(this).val())>-1){$(this).closest(".address").addClass("hide-postal-code");return}}$(this).closest(".address").removeClass("hide-postal-code")})},initShipping:function(){$("#shipping-method-list").on("click ifChecked",".input-radio",function(e){e.stopPropagation();var tgQuoteId=$(this).data("quoteid");$("input[name$=_tgQuoteId]").val(tgQuoteId)})},initCurrencyConversion:function(){currencySettings={targets:".tg_price, .price, .product-standard-price, .product-sales-price, .price-standard, .price-sales, .price-total, .mini-cart-price, .mini-cart-subtotals .value, tr.order-subtotal .value, tr.order-sales-tax .value, tr.order-shipping .value, tr.order-total .value, td.item-total, .order-totals-table tr td:nth-child(2), .order-shipment-table:nth-child(3), .payment-amount .value, .order-shipment-table td:nth-child(3), .mini-payment-instrument .details div:last",baseCurrency:app.tgresources.baseCurrency,currentCurrency:app.tgresources.baseCurrency,symbols:{USD:"&#36;"},rates:app.tgresources.currencyRates};var cookieCurrency=getTGCurrencyCookie();if(cookieCurrency===""){openWelcomeMat()}else{$("#welMat").addClass("hideWelMat");convertCurrency({newCurrency:cookieCurrency})}$(document).ajaxStop(function(){convertCurrency()});$(".tg_changecurrencylink").click(function(){openWelcomeMat()})}}}(window.app=window.app||{},jQuery));jQuery(document).ready(function(){app.tgcommerce.init()});